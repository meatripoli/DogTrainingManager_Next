{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport SignInLayout from '../components/SignInLayout';\nimport MyGrid from '../components/MyGrid';\nimport { Form, Button } from 'semantic-ui-react';\nimport { useState, useContext } from 'react';\nimport axios from 'axios';\nimport router from 'next/router';\nimport UserContext from '../components/util/UserContext';\nexport default (function (props) {\n  var _useContext = useContext(UserContext),\n      signIn = _useContext.signIn;\n\n  var _useState = useState({\n    color: 'grey',\n    body: 'Not registered yet? Contact your admin at email@example.com to create your account.'\n  }),\n      message = _useState[0],\n      setMessage = _useState[1];\n\n  var _useState2 = useState({\n    user: '',\n    password: ''\n  }),\n      login = _useState2[0],\n      setLogin = _useState2[1];\n\n  var handleSubmit = function handleSubmit(event) {\n    var response, newObj;\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            event.preventDefault();\n            _context.prev = 1;\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(axios.post('/login', login));\n\n          case 4:\n            response = _context.sent;\n            signIn(response.data.data.user, response.data.data.id, response.data.data.adminflag); //need to send the admin flag to users\n\n            router.push({\n              pathname: response.data.redirectUrl,\n              state: response.data.data\n            });\n            _context.next = 13;\n            break;\n\n          case 9:\n            _context.prev = 9;\n            _context.t0 = _context[\"catch\"](1);\n            console.log(_context.t0);\n\n            if (_context.t0.response.status === 401) {\n              newObj = {\n                body: 'Incorrect user or password',\n                color: 'red'\n              };\n              setMessage(_objectSpread({}, message, {}, newObj));\n            } else {\n              console.log(_context.t0.response);\n            }\n\n          case 13:\n            //done after data is sent for authentication\n            ///this clears object\n            setLogin({\n              user: '',\n              password: ''\n            });\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[1, 9]], Promise);\n  };\n\n  var handleLoginChange = function handleLoginChange(event) {\n    var newObj = _defineProperty({}, event.target.name, event.target.value);\n\n    setLogin(_objectSpread({}, login, {}, newObj));\n  };\n\n  return __jsx(SignInLayout, null, __jsx(MyGrid, {\n    columnNum: 2,\n    header: \"Login\",\n    body: message.body,\n    color: message.color\n  }, __jsx(Form, {\n    size: \"large\"\n  }, __jsx(Form.Input, {\n    fluid: true,\n    icon: \"user\",\n    iconPosition: \"left\",\n    placeholder: \"Username\",\n    onChange: handleLoginChange,\n    name: \"user\",\n    type: \"text\",\n    value: login.user\n  }), __jsx(Form.Input, {\n    fluid: true,\n    icon: \"lock\",\n    iconPosition: \"left\",\n    placeholder: \"Password\",\n    type: \"password\",\n    onChange: handleLoginChange,\n    name: \"password\",\n    value: login.password\n  }), __jsx(Button, {\n    type: \"submit\",\n    size: \"large\",\n    onClick: handleSubmit\n  }, \"Log In\"))));\n});","map":{"version":3,"sources":["/Users/meatripoli/ClassWork/FinalProject/pages/login.js"],"names":["SignInLayout","MyGrid","Form","Button","useState","useContext","axios","router","UserContext","props","signIn","color","body","message","setMessage","user","password","login","setLogin","handleSubmit","event","preventDefault","post","response","data","id","adminflag","push","pathname","redirectUrl","state","console","log","status","newObj","handleLoginChange","target","name","value"],"mappings":"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","sourcesContent":["import SignInLayout from '../components/SignInLayout';\nimport MyGrid from '../components/MyGrid';\nimport {Form, Button} from 'semantic-ui-react';\nimport {useState,useContext} from 'react';\nimport axios from 'axios';\nimport router from 'next/router'\nimport UserContext from '../components/util/UserContext';\n\nexport default (props) => {\n  const { signIn } = useContext(UserContext);\n  const [message,setMessage]=useState({\n    color:'grey',\n    body:'Not registered yet? Contact your admin at email@example.com to create your account.'\n  })\n  const [login,setLogin] = useState({\n    user: '',\n    password: ''\n  })\n  const handleSubmit = async (event)=>{\n    event.preventDefault();\n    try{\n      let response = await axios.post('/login',login)\n      signIn(response.data.data.user, response.data.data.id, response.data.data.adminflag)\n      //need to send the admin flag to users\n      router.push({ pathname: response.data.redirectUrl, state: response.data.data})\n    }\n    catch(e){\n      console.log(e)\n      if(e.response.status===401){\n        let newObj = {body: 'Incorrect user or password',color:'red'};\n        setMessage({...message,...newObj})\n      }\n      else{\n        console.log(e.response)\n      }\n    }\n    //done after data is sent for authentication\n    ///this clears object\n    setLogin({\n      user: '',\n      password: ''\n    });\n  };\n\n  const handleLoginChange = (event)=>{\n    let newObj = {[event.target.name]: event.target.value};\n    setLogin({...login,...newObj});\n  }\n\n  return (<SignInLayout>\n    <MyGrid \n        columnNum = {2} \n        header='Login'\n        body={message.body}\n        color={message.color}\n    >\n        <Form size=\"large\">\n            <Form.Input\n                fluid\n                icon=\"user\"\n                iconPosition=\"left\"\n                placeholder=\"Username\"\n                onChange={handleLoginChange}\n                name='user'\n                type='text'\n                value={login.user}\n            />\n            <Form.Input\n                fluid\n                icon=\"lock\"\n                iconPosition=\"left\"\n                placeholder=\"Password\"\n                type=\"password\"\n                onChange={handleLoginChange}\n                name='password'\n                value={login.password}\n            />\n            <Button type='submit' size=\"large\" onClick={handleSubmit}>Log In</Button>\n        </Form>\n    </MyGrid>\n  </SignInLayout>);\n};"]},"metadata":{},"sourceType":"module"}